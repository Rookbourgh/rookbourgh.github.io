<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>EuropaCraft Multi-Server Status</title>
  <style>
    :root{
      --ec-gold: rgb(128, 97, 0); /* gew√ºnschte Hauptfarbe */
      --ec-gold-2: rgb(192, 145, 0);
      --ec-blue: rgb(0, 5, 71);
      --bg: linear-gradient(180deg,#fbfbfb 0%, #e9e9e9 100%);
      --text-on-gold: #fff;
      --muted: rgba(255,255,255,0.85);
    }

    /* Grundlayout */
    html,body{height:100%;margin:0}
    body{
      font-family: "Segoe UI", Arial, sans-serif;
      background: var(--bg);
      display:flex;
      align-items:center;
      justify-content:center;
      padding:36px;
      color:#222;
    }

    /* Gesamt-Wrapper f√ºr nice spacing */
    .wrap{
      width:100%;
      max-width:1100px;
      display:flex;
      flex-direction:column;
      gap:24px;
      align-items:center;
    }

    /* Server-Karten-Container */
    .status-container{
      display:flex;
      gap:20px;
      flex-wrap:wrap;
      justify-content:center;
      width:100%;
    }

    /* einzelne Server-Karte im goldenen Look */
    .server-card{
      width:300px;
      min-height:160px;
      border-radius:16px;
      background: linear-gradient(145deg, var(--ec-gold) 0%, var(--ec-gold-2) 100%);
      border: 2px solid rgba(0,0,0,0.12);
      box-shadow: 0 8px 30px rgba(0,0,0,0.28), inset 0 1px 0 rgba(255,255,255,0.06);
      padding:18px;
      color:var(--text-on-gold);
      transition: transform .25s ease, box-shadow .25s ease;
      display:flex;
      flex-direction:column;
      justify-content:space-between;
      align-items:center;
      text-align:center;
    }

    .server-card:hover{
      transform: translateY(-6px);
      box-shadow: 0 16px 50px rgba(0,0,0,0.36), inset 0 1px 8px rgba(255,255,255,0.06);
    }

    .name{ font-weight:700; font-size:1.1rem; letter-spacing:.3px; margin-bottom:6px; color:#fff; text-shadow:0 1px 3px rgba(0,0,0,0.25) }
    .ip{ background:var(--ec-blue); color:#fff; padding:6px 10px; border-radius:8px; font-family:monospace; font-size:0.95rem; box-shadow:0 3px 6px rgba(0,0,0,0.18) }
    .status-line{ margin:10px 0; font-weight:700; font-size:1rem; display:flex; gap:8px; align-items:center; justify-content:center; }
    .status-online{ color:#6ef0a8; text-shadow:0 4px 18px rgba(110,240,168,0.12) }
    .status-offline{ color:#ff9a9a; text-shadow:0 4px 18px rgba(255,154,154,0.12) }

    .count{ color:#fff; font-weight:600; margin-bottom:8px }
    .players-row{ display:flex; gap:6px; flex-wrap:wrap; justify-content:center; margin-top:6px }

    .player{
      display:flex;
      align-items:center;
      gap:6px;
      background: rgba(255,255,255,0.16);
      color:#fff;
      padding:5px 8px;
      border-radius:8px;
      font-size:0.88rem;
      box-shadow: inset 0 1px 0 rgba(255,255,255,0.06);
    }

    .player img{ width:26px; height:26px; border-radius:4px; }

    /* Globaler Bereich (blau) */
    .global{
      width:100%;
      max-width:980px;
      border-radius:16px;
      background: linear-gradient(180deg, #10335a 0%, #11385f 100%);
      padding:18px;
      box-shadow: 0 10px 35px rgba(0,0,0,0.36);
      color:#fff;
      text-align:center;
    }

    .global h3{ margin:0 0 10px 0; font-size:1.15rem }
    .global-list{ display:flex; gap:8px; flex-wrap:wrap; justify-content:center }

    .muted-note{ color: #222; font-size:0.88rem; margin-top:6px; text-align:center }

    /* Buttons / copy action */
    .actions{ display:flex; gap:12px; align-items:center; justify-content:center; margin-top:6px }
    .btn{
      background:var(--ec-blue);
      color:#fff;
      border:none;
      padding:8px 14px;
      border-radius:10px;
      font-weight:700;
      cursor:pointer;
      box-shadow:0 6px 14px rgba(29,78,137,0.25);
      transition:transform .18s ease;
    }
    .btn:hover{ transform:translateY(-3px); background:#143a67 }

    /* responsive */
    @media (max-width:960px){
      .server-card{ width:44% }
    }
    @media (max-width:640px){
      .server-card{ width:100% }
    }
  </style>
</head>
<body>
  <div class="wrap">
    <div class="status-container" id="status-container">
      <!-- Karten werden per JS eingef√ºgt -->
    </div>

    <div class="global" id="global-wrap">
      <h3>üåç Alle Spieler auf EuropaCraft</h3>
      <div class="global-list" id="global-list">
        <!-- globale Playerliste -->
      </div>
      <div class="muted-note">Die Nodes sind intern √ºber den Proxy erreichbar ‚Äî dieser zeigt die aggregierten Spieler.</div>
    </div>

    <div class="actions" style="margin-top:12px">
      <button class="btn" onclick="copyIP()">üìã IP kopieren</button>
      <button class="btn" onclick="location.reload()">üîÑ Jetzt aktualisieren</button>
    </div>
  </div>

  <script>
    /* *** KONFIGURATION - HIER SERVER EINTRAGEN (name / host:port) *** */
    const servers = [
      { name: "Proxy", host: "play.europa-craft.de" },
      { name: "Node 1", host: "europapark.europa-craft.de" },
      { name: "Node 2", host: "node1.novium.world:21005" }
    ];

    const statusContainer = document.getElementById('status-container');
    const globalList = document.getElementById('global-list');

    async function fetchStatus(host){
      try{
        const r = await fetch(`https://api.mcsrvstat.us/2/${host}`);
        if(!r.ok) return { error:true };
        return await r.json();
      }catch(e){
        return { error:true };
      }
    }

    function makeCard(name, host, data){
      const card = document.createElement('div');
      card.className = 'server-card';

      const players = (data && data.players && Array.isArray(data.players.list)) ? data.players.list : [];
      const onlineCount = (data && data.players && typeof data.players.online === 'number') ? data.players.online : 0;
      const maxCount = (data && data.players && typeof data.players.max === 'number') ? data.players.max : '?';
      const isOnline = data && data.online;

      const statusHtml = isOnline
        ? `<div class="status-line"><span class="status-online">üü© Online</span></div>`
        : `<div class="status-line"><span class="status-offline">üü• Offline</span></div>`;

      const playersHtml = players.length
        ? players.map(p => `<div class="player"><img src="https://mc-heads.net/avatar/${encodeURIComponent(p)}/28" alt="${p}">${p}</div>`).join('')
        : `<div style="color:rgba(255,255,255,0.9)">Keine Spieler online</div>`;

      card.innerHTML = `
        <div class="name">${name}</div>
        <div class="ip">${host}</div>
        ${statusHtml}
        <div class="count">${isOnline ? `${onlineCount} / ${maxCount} Spieler` : ''}</div>
        <div class="players-row">${playersHtml}</div>
      `;
      return { card, players };
    }

    async function updateAll(){
      statusContainer.innerHTML = '';
      globalList.innerHTML = '';
      const globalSet = new Set();

      // parallel abfragen, aber in Reihenfolge anzeigen
      const promises = servers.map(s => fetchStatus(s.host));
      const results = await Promise.all(promises);

      for(let i=0;i<servers.length;i++){
        const s = servers[i];
        const data = results[i] && !results[i].error ? results[i] : { online:false };
        const { card, players } = makeCard(s.name, s.host, data);
        statusContainer.appendChild(card);
        // aggregate players
        if(players && players.length){
          players.forEach(p => globalSet.add(p));
        }
      }

      if(globalSet.size){
        globalSet.forEach(p => {
          const div = document.createElement('div');
          div.className = 'player';
          div.innerHTML = `<img src="https://mc-heads.net/avatar/${encodeURIComponent(p)}/28" alt="${p}">${p}`;
          globalList.appendChild(div);
        });
      } else {
        globalList.innerHTML = `<div style="color:rgba(255,255,255,0.9)">Keine Spieler online üí§</div>`;
      }
    }

    // copy helper
    function copyIP(){
      navigator.clipboard.writeText('play.europacraft.de').then(()=>{
        alert('IP kopiert: play.europacraft.de');
      }).catch(()=>alert('Kopieren fehlgeschlagen.'));
    }

    // initial + interval
    updateAll();
    setInterval(updateAll, 30000);
  </script>
</body>
</html>

<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>EuropaCraft Proxy Status</title>
<style>
  :root{
    --gold: rgb(128,97,0);
    --gold-2: rgb(165,125,10);
    --blue: #142e5a;
    --glass: rgba(10,20,50,0.55);
    --white: #ffffff;
    --muted: rgba(255,255,255,0.85);
    --card-max: 720px;
  }

  /* Reset & body */
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;font-family:Inter, "Segoe UI", Arial, sans-serif;background:#161b46;}
  body{display:flex;align-items:center;justify-content:center;padding:36px}

  /* wrapper responsive: desktop ~40-50% width, mobile ~90% */
  .wrap {
    width: 92%;
    max-width: var(--card-max);
    display:flex;
    justify-content:center;
  }

  /* card */
  .ec-card {
    width:100%;
    border-radius:18px;
    padding:22px;
    position:relative;
    overflow:hidden;
    text-align:center;
    color:var(--white);
    background: linear-gradient(180deg, rgba(255,255,255,0.02), rgba(255,255,255,0.01));
    backdrop-filter: blur(6px);
    -webkit-backdrop-filter: blur(6px);
    border: 2px solid rgba(255,220,120,0.06);
    box-shadow:
      0 10px 40px rgba(5,8,20,0.6),
      0 0 30px rgba(128,97,0,0.08);
    transition:transform .25s ease, box-shadow .25s ease;
  }
  .ec-card:hover{ transform: translateY(-4px); box-shadow: 0 16px 55px rgba(5,8,20,0.65), 0 0 40px rgba(128,97,0,0.12); }

  /* gold frame (thin) */
 .ec-frame {
  position: absolute;
  inset: -2px;
  border-radius: 20px;
  pointer-events: none;

  /* Rahmenfarbe */
  border: 3px solid rgb(128, 97, 0);

  /* Ã¤uÃŸerer Glow */
  box-shadow: 
      0 0 12px rgba(128, 97, 0, 0.65),
      0 0 22px rgba(128, 97, 0, 0.45),
      0 0 40px rgba(128, 97, 0, 0.25);

  /* innerer Schimmer */
  background: linear-gradient(
      rgba(255, 225, 150, 0.05),
      rgba(128, 97, 0, 0.05)
  );
}


  /* stars (decor) */
  .stars { position:absolute; inset:0; pointer-events:none; }
  .star {
    position:absolute; width:16px; height:16px; transform-origin:center;
    filter: drop-shadow(0 3px 6px rgba(0,0,0,0.6));
    opacity:0.95;
  }
  /* small key positions */
  .s1{ top:14px; left:14%; animation:float 6s ease-in-out infinite; }
  .s2{ top:8px; right:18%; animation:float 5.4s ease-in-out infinite; transform:scale(.9); }
  .s3{ top:6px; left:82%; animation:float 7s ease-in-out infinite; transform:scale(1.05); }
  .s4{ bottom:12px; left:10%; animation:float 8s ease-in-out infinite; transform:scale(.95); }
  @keyframes float { 0%{ transform:translateY(0) } 50%{ transform:translateY(-6px) } 100%{ transform:translateY(0) } }

  /* Title */
  .ec-title {
    font-size: clamp(18px, 2.4vw, 28px);
    font-weight:800;
    color:var(--white);
    text-shadow:0 4px 18px rgba(0,0,0,0.45);
    margin:6px 0 12px;
    letter-spacing: .6px;
  }

  /* small ip badge */
  .ip-badge {
    display:inline-block;
    background:var(--gold);
    color:var(--blue);
    padding:6px 12px;
    border-radius:10px;
    font-family:monospace;
    font-weight:700;
    box-shadow: 0 4px 18px rgba(0,0,0,0.4), inset 0 1px 0 rgba(255,255,255,0.12);
    margin-bottom:12px;
  }

  /* status badge */
  .status-badge {
    display:inline-block;
    padding:8px 18px;
    border-radius:12px;
    font-weight:700;
    margin:10px 0;
    box-shadow: 0 6px 18px rgba(0,0,0,0.35);
    font-size: clamp(13px,1.6vw,16px);
  }
  .online { background:linear-gradient(90deg,#00ffb2,#00c78a); color:#062a18; }
  .offline { background:#ff6b6b; color:#fff; }

  /* counts */
  .counts { margin:10px 0 12px; font-weight:700; color:var(--muted) }

  /* player list (scroll) */
  .players {
    margin: 10px auto 6px;
    max-height: 160px;
    overflow-y: auto;
    display:flex;
    gap:8px;
    flex-wrap:wrap;
    justify-content:center;
    padding:8px;
    background: linear-gradient(180deg, rgba(255,255,255,0.03), rgba(255,255,255,0.01));
    border-radius:12px;
    border: 1px solid rgba(255,255,255,0.03);
  }
  .player {
    display:flex;
    align-items:center;
    gap:8px;
    padding:6px 10px;
    background: rgba(255,255,255,0.06);
    color:var(--white);
    border-radius:12px;
    font-weight:600;
    white-space:nowrap;
    transform:translateZ(0);
    transition: transform .15s ease, background .15s ease;
  }
  .player:hover{ transform:translateY(-4px); background: rgba(255,255,255,0.10) }
  .player img { width:32px; height:32px; border-radius:6px; display:block; }

  /* no players */
  .no-players {
    padding:18px;
    color:rgba(255,255,255,0.75);
    font-weight:600;
    width:100%;
  }

  /* footer controls */
  .ec-actions { display:flex; gap:10px; justify-content:center; margin-top:12px; flex-wrap:wrap; }
  .btn {
    background: linear-gradient(180deg,var(--gold-2),var(--gold));
    color:var(--blue);
    border:none;
    padding:8px 14px;
    border-radius:10px;
    font-weight:800;
    cursor:pointer;
    box-shadow:0 10px 24px rgba(128,97,0,0.18), inset 0 1px 0 rgba(255,255,255,0.12);
  }
  .btn:hover{ transform:translateY(-3px); opacity:0.95; }

  /* small note */
  .note { margin-top:8px; font-size:13px; color:rgba(255,255,255,0.75) }

  /* responsive layout tweaks */
  @media (min-width:1100px){
    .wrap{ width:60% }
  }
  @media (min-width:1600px){
    .wrap{ width:48%; max-width:820px }
  }
  @media (max-width:520px){
    .players{ gap:6px }
    .player img{ width:28px; height:28px }
  }
</style>
</head>
<body>
<input id="copyHidden" type="text" value="play.europa-craft.de" 
       style="position:absolute;opacity:0;pointer-events:none;height:0;width:0;border:0;padding:0;margin:0;">
  <div class="wrap">
    <div class="ec-card" id="ec-card" role="region" aria-label="EuropaCraft Proxy Status">
      <div class="ec-frame" aria-hidden="true"></div>

      <!-- animated stars SVG -->
      <div class="stars" aria-hidden="true">
        <svg class="star s1" viewBox="0 0 24 24"><path fill="#ffd86b" d="M12 2l2.6 5.3L20 9l-4 3.6L17 20l-5-2.7L7 20l1-7.4L4 9l5.4-1.7z"/></svg>
        <svg class="star s2" viewBox="0 0 24 24"><path fill="#ffd86b" d="M12 2l2.6 5.3L20 9l-4 3.6L17 20l-5-2.7L7 20l1-7.4L4 9l5.4-1.7z"/></svg>
        <svg class="star s3" viewBox="0 0 24 24"><path fill="#ffd86b" d="M12 2l2.6 5.3L20 9l-4 3.6L17 20l-5-2.7L7 20l1-7.4L4 9l5.4-1.7z"/></svg>
        <svg class="star s4" viewBox="0 0 24 24"><path fill="#ffd86b" d="M12 2l2.6 5.3L20 9l-4 3.6L17 20l-5-2.7L7 20l1-7.4L4 9l5.4-1.7z"/></svg>
      </div>

      <div class="ec-title">EuropaCraft Proxy</div>

      <div id="ip" class="ip-badge" aria-hidden="true">play.europa-craft.de</div>

      <div id="statusBadge" class="status-badge offline">Lade...</div>

      <div id="counts" class="counts" aria-live="polite">â€“</div>

      <div id="players" class="players" aria-live="polite">
        <div class="no-players">Lade Spielerliste â€¦</div>
      </div>

      <div class="ec-actions">
        <button class="btn" id="copyBtn" title="IP kopieren">ðŸ“‹ IP kopieren</button>
        <button class="btn" id="refreshBtn" title="Jetzt aktualisieren">ðŸ”„ Jetzt aktualisieren</button>
      </div>

      <div class="note">Die Anzeige basiert auf dem Proxy. Nodes laufen intern Ã¼ber den Proxy.</div>
    </div>
  </div>

<script>
/* Configuration */
const SERVER = "play.europa-craft.de"; // <- DEINE PROXY-DOMAIN
const API = `https://api.mcsrvstat.us/2/${SERVER}`;
const REFRESH_MS = 15000; // 15s

/* Elements */
const statusBadge = document.getElementById('statusBadge');
const counts = document.getElementById('counts');
const playersWrap = document.getElementById('players');
const copyBtn = document.getElementById('copyBtn');
const refreshBtn = document.getElementById('refreshBtn');

/* copy action */
copyBtn.addEventListener('click', () => {
  const hidden = document.getElementById('copyHidden');
  hidden.value = SERVER;

  if (navigator.clipboard && navigator.clipboard.writeText) {
    navigator.clipboard.writeText(SERVER).then(() => {
      copyBtn.textContent = "âœ… Kopiert";
      setTimeout(() => copyBtn.textContent = "ðŸ“‹ IP kopieren", 1500);
    }).catch(() => {
      // Fallback, wenn Clipboard API in iFrame blockiert ist
      hidden.select();
      hidden.setSelectionRange(0, SERVER.length);
      document.execCommand("copy");

      copyBtn.textContent = "âœ… Kopiert";
      setTimeout(() => copyBtn.textContent = "ðŸ“‹ IP kopieren", 1500);
    });
  } else {
    // Nur Fallback
    hidden.select();
    hidden.setSelectionRange(0, SERVER.length);
    document.execCommand("copy");

    copyBtn.textContent = "âœ… Kopiert";
    setTimeout(() => copyBtn.textContent = "ðŸ“‹ IP kopieren", 1500);
  }
});


/* refresh action */
refreshBtn.addEventListener('click', ()=> { update(); });

/* helper to build player element */
function makePlayerHtml(name) {
  const url = `https://crafatar.com/avatars/${encodeURIComponent(name)}?size=64&overlay`;
  return `<div class="player" title="${escapeHtml(name)}">
            <img src="${url}" alt="${escapeHtml(name)} avatar" loading="lazy">
            <div style="font-weight:700">${escapeHtml(name)}</div>
          </div>`;
}

/* small escape for safety */
function escapeHtml(s){ return String(s).replace(/[&<>"']/g, (m)=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m])); }

/* update UI */
async function update(){
  statusBadge.textContent = 'Ladeâ€¦';
  statusBadge.className = 'status-badge offline';
  counts.textContent = 'â€¦';
  playersWrap.innerHTML = '<div class="no-players">Lade Spielerliste â€¦</div>';

  try {
    const res = await fetch(API);
    if(!res.ok){ throw new Error('API Fehler'); }
    const data = await res.json();

    const online = !!data.online;
    const players = data.players && Array.isArray(data.players.list) ? data.players.list : [];
    const onlineCount = data.players && typeof data.players.online === 'number' ? data.players.online : 0;
    const maxCount = data.players && typeof data.players.max === 'number' ? data.players.max : '?';

    if(online){
      statusBadge.textContent = 'Online';
      statusBadge.className = 'status-badge online';
      counts.textContent = `${onlineCount} / ${maxCount} Spieler online`;
    } else {
      statusBadge.textContent = 'Offline';
      statusBadge.className = 'status-badge offline';
      counts.textContent = `Server nicht erreichbar`;
      playersWrap.innerHTML = `<div class="no-players">Der Proxy antwortet nicht.</div>`;
      return;
    }

    if(players.length){
      // render avatars (unique order preserved)
      const seen = new Set();
      const html = [];
      for(const p of players){
        if(!seen.has(p)){
          seen.add(p);
          html.push(makePlayerHtml(p));
        }
      }
      playersWrap.innerHTML = html.join('');
    } else {
      playersWrap.innerHTML = `<div class="no-players">Keine Spieler online ðŸ’¤</div>`;
    }

  } catch(e){
    statusBadge.textContent = 'Fehler';
    statusBadge.className = 'status-badge offline';
    counts.textContent = 'Fehler beim Abrufen';
    playersWrap.innerHTML = `<div class="no-players">Abfrage fehlgeschlagen.</div>`;
    console.error(e);
  }
}

/* initial + loop */
update();
setInterval(update, REFRESH_MS);

/* accessibility: refresh on visibility change (when user returns) */
document.addEventListener('visibilitychange', ()=> { if(!document.hidden) update(); });

</script>
</body>
</html>
